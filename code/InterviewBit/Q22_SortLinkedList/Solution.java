package Q22_SortLinkedList;

import Q21_InsertionSortList.Solution.ListNode;

import java.util.Random;

public class Solution {

  public ListNode sortList(ListNode A) {
    if (A == null) {
      return null;
    }

    ListNode end = A;
    while (end.next != null) {
      end = end.next;
    }

    sort(A, end);
    return A;
  }

  private void sort(ListNode start, ListNode end) {
    if (start == end) {
      return;
    }

    // split list and partition recurse
    ListNode pivotPrev = partition(start, end);

    if (pivotPrev == null) {
      return;
    }

    sort(start, pivotPrev);

    ListNode rightStart = pivotPrev.next;
    if (start != pivotPrev && rightStart != null && rightStart != end) {
      rightStart = rightStart.next;
    }

    sort(rightStart, end);
  }

  private ListNode partition(ListNode start, ListNode end) {
    if (start == end || start == null || end == null) {
      return start;
    }

    ListNode pivotPrev = start;
    ListNode curr = start;
    int pivot = end.val;

    while (start != end) {
      if (start.val < pivot) {
        // keep tracks of last modified item
        pivotPrev = curr;
        swap(curr, start);
        curr = curr.next;
      }

      start = start.next;
    }

    swap(end, curr);
    return pivotPrev;
  }

  private void swap(ListNode i, ListNode j) {
    if (i != j) {
      int temp = i.val;
      i.val = j.val;
      j.val = temp;
    }
  }

  public static void main(String[] args) {
    int[] array = {1, 3, 2};
    runTestCase(array);

    array = new int[] {19, 31, 26, 98, 67, 100, 2, 24, 6, 37, 69, 11, 16, 61, 23};
    runTestCase(array);

    array =
        new int[] {
          48, 5, 66, 68, 42, 73, 25, 84, 63, 72, 20, 77, 38, 8, 99, 92, 49, 74, 45, 30, 51, 50, 95,
              56,
          19, 31, 26, 98, 67, 100, 2, 24, 6, 37, 69, 11, 16, 61, 23, 78, 27, 64, 87, 3, 85, 55, 22,
              33,
          62
        };
    runTestCase(array);

    final int MAX = 1000000000;
    final Random random = new Random();
    for (int i = 100; i <= MAX; i *= 10) {
      array = new int[i];
      for (int j = 0; j < array.length; j++) {
        array[j] = random.nextInt(MAX);
      }
      runTestCase(array);
    }
  }

  private static void runTestCase(int[] array) {
    ListNode a = null;
    ListNode prev = null;
    for (int i : array) {
      ListNode node = new ListNode(i);
      if (a == null) {
        a = node;
      }
      if (prev != null) {
        prev.next = node;
      }
      prev = node;
    }

    System.out.println("a = " + array.length + (array.length > 1000 ? "" : ": " + a));

    long start = System.nanoTime();
    ListNode ans = new Solution().sortList(a);
    long end = System.nanoTime();
    ListNode ans2 =
        array.length > 100000 ? ans : new Q21_InsertionSortList.Solution().insertionSortList(a);
    long end2 = System.nanoTime();

    if (array.length <= 1000) {
      System.out.println("ans: " + a);
    }

    System.out.println(
        "Quick sort elapsed time (s): " + (double) (end - start) / 1000.0 / 1000.0 / 1000.0);
    if (array.length <= 100000) {
      System.out.println(
          "Insertion sort elapsed time (s): " + (double) (end2 - end) / 1000.0 / 1000.0 / 1000.0);
    }

    prev = ans;
    ListNode curr = ans.next;
    ListNode curr2 = ans2.next;

    while (curr != null) {
      if (prev.val > curr.val || curr.val != curr2.val) {
        throw new AssertionError();
      }
      prev = curr;
      curr = curr.next;
      curr2 = curr2.next;
    }
  }
}

/*
/Library/Java/JavaVirtualMachines/adoptopenjdk-11.jdk/Contents/Home/bin/java -Xms512m -Xmx128g -javaagent:/Applications/IntelliJ IDEA CE.app/Contents/lib/idea_rt.jar=64388:/Applications/IntelliJ IDEA CE.app/Contents/bin -Dfile.encoding=UTF-8 -classpath /Users/donghao/Documents/code/exam/CtCI_v6/out/production/CtCI_v6 Q22_SortLinkedList.Solution
a = 3: 1 -> 3 -> 2
ans: 1 -> 2 -> 3
Quick sort elapsed time (s): 7.024E-6
Insertion sort elapsed time (s): 5.516420000000001E-4
a = 15: 19 -> 31 -> 26 -> 98 -> 67 -> 100 -> 2 -> 24 -> 6 -> 37 -> 69 -> 11 -> 16 -> 61 -> 23
ans: 2 -> 6 -> 11 -> 16 -> 19 -> 23 -> 24 -> 26 -> 31 -> 37 -> 61 -> 67 -> 69 -> 98 -> 100
Quick sort elapsed time (s): 5.961E-6
Insertion sort elapsed time (s): 2.0357000000000002E-5
a = 49: 48 -> 5 -> 66 -> 68 -> 42 -> 73 -> 25 -> 84 -> 63 -> 72 -> 20 -> 77 -> 38 -> 8 -> 99 -> 92 -> 49 -> 74 -> 45 -> 30 -> 51 -> 50 -> 95 -> 56 -> 19 -> 31 -> 26 -> 98 -> 67 -> 100 -> 2 -> 24 -> 6 -> 37 -> 69 -> 11 -> 16 -> 61 -> 23 -> 78 -> 27 -> 64 -> 87 -> 3 -> 85 -> 55 -> 22 -> 33 -> 62
ans: 2 -> 3 -> 5 -> 6 -> 8 -> 11 -> 16 -> 19 -> 20 -> 22 -> 23 -> 24 -> 25 -> 26 -> 27 -> 30 -> 31 -> 33 -> 37 -> 38 -> 42 -> 45 -> 48 -> 49 -> 50 -> 51 -> 55 -> 56 -> 61 -> 62 -> 63 -> 64 -> 66 -> 67 -> 68 -> 69 -> 72 -> 73 -> 74 -> 77 -> 78 -> 84 -> 85 -> 87 -> 92 -> 95 -> 98 -> 99 -> 100
Quick sort elapsed time (s): 1.8389E-5
Insertion sort elapsed time (s): 1.9810999999999997E-5
a = 100: 511550406 -> 638735441 -> 491078578 -> 825964113 -> 124210392 -> 408981786 -> 986312313 -> 736759706 -> 355532135 -> 980986829 -> 236667563 -> 271564365 -> 35077382 -> 379174480 -> 711324713 -> 773504160 -> 825266691 -> 878879801 -> 900101734 -> 392842426 -> 7530788 -> 847572479 -> 742730607 -> 897286231 -> 454577879 -> 59255787 -> 915511540 -> 194969098 -> 553156179 -> 23986219 -> 874134007 -> 647234208 -> 226784844 -> 938316293 -> 579305744 -> 799645861 -> 795564882 -> 771147305 -> 45643098 -> 412736000 -> 81310663 -> 775182367 -> 813771262 -> 810234297 -> 425311099 -> 313714399 -> 588084826 -> 83869148 -> 298785510 -> 284425343 -> 610820813 -> 955428725 -> 563923457 -> 644586247 -> 990365217 -> 844811962 -> 257600193 -> 855921248 -> 242944918 -> 989054280 -> 474586929 -> 606803307 -> 521133447 -> 986285702 -> 312335147 -> 781573167 -> 249045691 -> 830582310 -> 108460978 -> 874892586 -> 530191435 -> 420490442 -> 928365039 -> 681519147 -> 11089091 -> 540342727 -> 375689713 -> 715448918 -> 245025012 -> 622420501 -> 977291453 -> 558184602 -> 905442773 -> 208043657 -> 71960643 -> 124978429 -> 526106908 -> 760875151 -> 606964427 -> 26819157 -> 245921583 -> 464601009 -> 149436477 -> 716793242 -> 51440703 -> 232865010 -> 247985352 -> 905985470 -> 914627143 -> 539213602
ans: 7530788 -> 11089091 -> 23986219 -> 26819157 -> 35077382 -> 45643098 -> 51440703 -> 59255787 -> 71960643 -> 81310663 -> 83869148 -> 108460978 -> 124210392 -> 124978429 -> 149436477 -> 194969098 -> 208043657 -> 226784844 -> 232865010 -> 236667563 -> 242944918 -> 245025012 -> 245921583 -> 247985352 -> 249045691 -> 257600193 -> 271564365 -> 284425343 -> 298785510 -> 312335147 -> 313714399 -> 355532135 -> 375689713 -> 379174480 -> 392842426 -> 408981786 -> 412736000 -> 420490442 -> 425311099 -> 454577879 -> 464601009 -> 474586929 -> 491078578 -> 511550406 -> 521133447 -> 526106908 -> 530191435 -> 539213602 -> 540342727 -> 553156179 -> 558184602 -> 563923457 -> 579305744 -> 588084826 -> 606803307 -> 606964427 -> 610820813 -> 622420501 -> 638735441 -> 644586247 -> 647234208 -> 681519147 -> 711324713 -> 715448918 -> 716793242 -> 736759706 -> 742730607 -> 760875151 -> 771147305 -> 773504160 -> 775182367 -> 781573167 -> 795564882 -> 799645861 -> 810234297 -> 813771262 -> 825266691 -> 825964113 -> 830582310 -> 844811962 -> 847572479 -> 855921248 -> 874134007 -> 874892586 -> 878879801 -> 897286231 -> 900101734 -> 905442773 -> 905985470 -> 914627143 -> 915511540 -> 928365039 -> 938316293 -> 955428725 -> 977291453 -> 980986829 -> 986285702 -> 986312313 -> 989054280 -> 990365217
Quick sort elapsed time (s): 1.1310099999999999E-4
Insertion sort elapsed time (s): 1.16866E-4
a = 1000: 463538687 -> 251097756 -> 698090931 -> 627219981 -> 154129701 -> 969465932 -> 586351356 -> 891988748 -> 875622739 -> 997081869 -> 292450276 -> 530968759 -> 465702978 -> 493758270 -> 864985168 -> 209281464 -> 985362870 -> 333565831 -> 968121021 -> 212366523 -> 678261128 -> 110869269 -> 484146784 -> 925843329 -> 294876238 -> 12078082 -> 939057374 -> 53013780 -> 587011240 -> 571190738 -> 661885861 -> 363197205 -> 316576554 -> 740467737 -> 346762981 -> 692759089 -> 787413729 -> 993083195 -> 228350511 -> 171529860 -> 419913548 -> 990785192 -> 267333682 -> 355258937 -> 612541717 -> 434546921 -> 749375850 -> 207136768 -> 726878008 -> 48615031 -> 84467496 -> 93379264 -> 137362283 -> 428690650 -> 174362463 -> 761038828 -> 117974496 -> 939052124 -> 809710936 -> 600633298 -> 377684165 -> 962489952 -> 974988807 -> 541866471 -> 699187548 -> 790100856 -> 549837139 -> 728166002 -> 326250612 -> 562831720 -> 106162461 -> 427285203 -> 964196532 -> 284025072 -> 519918322 -> 312862398 -> 546366954 -> 546831196 -> 513517456 -> 419643723 -> 475988254 -> 499222554 -> 553109864 -> 567725883 -> 428852399 -> 875669454 -> 634136397 -> 964691289 -> 602312716 -> 532577411 -> 886923192 -> 216846076 -> 853424907 -> 295781627 -> 150175925 -> 575345385 -> 458067239 -> 632873582 -> 950224597 -> 303578335 -> 840216498 -> 760055890 -> 27465927 -> 223483997 -> 973237431 -> 593304802 -> 107906972 -> 635184870 -> 898275732 -> 266526744 -> 910622565 -> 670790535 -> 20969942 -> 244528756 -> 922030187 -> 241021429 -> 558821715 -> 607192722 -> 99215682 -> 396511063 -> 585921487 -> 681202907 -> 93579836 -> 72438518 -> 922793086 -> 600321283 -> 533308258 -> 360795265 -> 269356071 -> 370078340 -> 177130003 -> 237785432 -> 539166285 -> 456454134 -> 253156171 -> 379216509 -> 923285780 -> 687000432 -> 383522324 -> 399199566 -> 708380456 -> 175336069 -> 651871391 -> 955388119 -> 40403676 -> 928904382 -> 662164082 -> 992449061 -> 75062701 -> 650259795 -> 179710618 -> 250124682 -> 609641668 -> 521201797 -> 212880636 -> 456133774 -> 310650265 -> 140243611 -> 381491402 -> 11249266 -> 302937777 -> 492070006 -> 660349457 -> 14776161 -> 721444487 -> 613353427 -> 252644406 -> 800558217 -> 370131741 -> 585957601 -> 378028260 -> 859702841 -> 635498221 -> 292326585 -> 37315974 -> 545972852 -> 868508959 -> 924561327 -> 450692100 -> 345855696 -> 166025106 -> 634888975 -> 85826654 -> 512648990 -> 743186043 -> 685075985 -> 464446872 -> 744684815 -> 417242214 -> 12908870 -> 490257219 -> 839006667 -> 635847587 -> 153904795 -> 91014217 -> 20274662 -> 731097730 -> 607588192 -> 701147134 -> 891704464 -> 176604733 -> 280943506 -> 34981481 -> 928361751 -> 323750188 -> 670700430 -> 738610805 -> 105610781 -> 875232083 -> 81507263 -> 66414667 -> 262329523 -> 398663993 -> 59925586 -> 153053704 -> 287070362 -> 528355130 -> 605466253 -> 467381744 -> 92887958 -> 255099119 -> 576653137 -> 120799148 -> 409586091 -> 691908982 -> 617331156 -> 30426673 -> 992300401 -> 339900421 -> 170908374 -> 830062920 -> 516707735 -> 533747880 -> 44100857 -> 64204434 -> 288173485 -> 697623482 -> 424708075 -> 707969185 -> 917140768 -> 454574255 -> 591125951 -> 60245367 -> 81032560 -> 234233130 -> 983490312 -> 891873257 -> 931241540 -> 574279054 -> 86391018 -> 471990487 -> 374141855 -> 975617245 -> 520365646 -> 87392483 -> 754829986 -> 538713282 -> 877987519 -> 544017212 -> 753380600 -> 244966826 -> 335793380 -> 398174104 -> 305773793 -> 765412620 -> 958027930 -> 254816064 -> 96545247 -> 678511562 -> 262421166 -> 919146309 -> 760551415 -> 778816175 -> 296302132 -> 683993508 -> 249869080 -> 528276358 -> 416567959 -> 109707870 -> 847792560 -> 746305756 -> 723810924 -> 329980353 -> 189449044 -> 830566383 -> 469795166 -> 130025493 -> 183614144 -> 485214052 -> 514152731 -> 327373403 -> 762147231 -> 325924423 -> 895880742 -> 151054883 -> 755974684 -> 713063230 -> 415054960 -> 639905006 -> 127102507 -> 992172469 -> 907062447 -> 357248678 -> 7432520 -> 353913763 -> 449309303 -> 432380904 -> 489458313 -> 758451405 -> 878421819 -> 923238017 -> 242715952 -> 303127788 -> 469770291 -> 973451428 -> 396469344 -> 658271868 -> 702219720 -> 477946349 -> 769530916 -> 207267983 -> 516044364 -> 667699901 -> 499619803 -> 299348392 -> 421495721 -> 769523200 -> 173231570 -> 12849153 -> 356953112 -> 964336081 -> 537997586 -> 602675624 -> 339872483 -> 391318050 -> 254766569 -> 874861569 -> 159573250 -> 920354693 -> 398082323 -> 264035051 -> 157881000 -> 992658514 -> 940680352 -> 432874240 -> 151397882 -> 674876017 -> 718837098 -> 85476058 -> 678623685 -> 986276328 -> 250879840 -> 533346274 -> 626017078 -> 382230543 -> 979996269 -> 363125267 -> 388433211 -> 613011407 -> 688966589 -> 965752893 -> 686159268 -> 80894932 -> 313240595 -> 548409253 -> 497606470 -> 32841755 -> 528027951 -> 121518680 -> 392450345 -> 480746988 -> 566001279 -> 161631665 -> 199382856 -> 413581628 -> 176038961 -> 966464524 -> 596711642 -> 249954981 -> 781396134 -> 740431605 -> 841070314 -> 363835515 -> 718480726 -> 333408239 -> 563112468 -> 117353709 -> 913455251 -> 153168817 -> 745532561 -> 155795309 -> 866620313 -> 572571817 -> 741474724 -> 97988920 -> 61094497 -> 185967556 -> 358440612 -> 858284209 -> 411367869 -> 132047797 -> 415824560 -> 145062585 -> 823768273 -> 583537140 -> 825995684 -> 98377374 -> 953545820 -> 728587994 -> 667413506 -> 829775745 -> 718591717 -> 491595685 -> 740304539 -> 484646849 -> 781438321 -> 628904363 -> 938263767 -> 394284153 -> 78232236 -> 598841249 -> 136028447 -> 631127776 -> 871785024 -> 79353073 -> 66726221 -> 188375445 -> 332947055 -> 462845943 -> 636209350 -> 222029151 -> 370613729 -> 214586540 -> 937317308 -> 393865768 -> 766749513 -> 596046013 -> 114315460 -> 572959294 -> 471213704 -> 348179746 -> 721339682 -> 939271406 -> 131101559 -> 620619609 -> 230712557 -> 756491346 -> 812328185 -> 937099556 -> 761764681 -> 292253726 -> 372285310 -> 496988249 -> 293449535 -> 469843935 -> 876203998 -> 518498902 -> 264630949 -> 528032091 -> 735148866 -> 185492101 -> 940863379 -> 930616017 -> 762262616 -> 6878107 -> 927755982 -> 734851239 -> 635753550 -> 384464830 -> 553794532 -> 873459110 -> 892496028 -> 220264929 -> 667461795 -> 313477762 -> 539714928 -> 734280830 -> 643169450 -> 520072891 -> 732710968 -> 463594903 -> 635660749 -> 788331505 -> 989626450 -> 599037845 -> 12468469 -> 781999599 -> 306162641 -> 13501728 -> 481403051 -> 977994151 -> 368956904 -> 186543090 -> 49220227 -> 480566607 -> 346819941 -> 480732453 -> 894620325 -> 592071886 -> 923598961 -> 506533113 -> 424214868 -> 746709511 -> 688275311 -> 747767663 -> 312258045 -> 509621309 -> 882351336 -> 95506970 -> 497342209 -> 374434767 -> 599834436 -> 541459528 -> 950627844 -> 502635800 -> 882444553 -> 668066206 -> 102186175 -> 608870188 -> 364753782 -> 933132368 -> 724214160 -> 569421184 -> 755799041 -> 93949270 -> 796244329 -> 34595256 -> 794322820 -> 554102886 -> 141902155 -> 797941018 -> 171357635 -> 35461147 -> 179256976 -> 518866115 -> 100040059 -> 151171878 -> 172264252 -> 39176849 -> 425088008 -> 367620174 -> 42766699 -> 241758896 -> 783179047 -> 879221226 -> 759955396 -> 797310166 -> 464989102 -> 574575074 -> 727553456 -> 360124248 -> 105133999 -> 129450753 -> 51018068 -> 41279348 -> 662702288 -> 442770171 -> 692859933 -> 878117623 -> 798939710 -> 672367117 -> 945961361 -> 610599487 -> 454570515 -> 827024650 -> 462591872 -> 154005629 -> 212140121 -> 950576426 -> 118022642 -> 45286830 -> 610525190 -> 876704115 -> 69485937 -> 816142736 -> 178669148 -> 614792379 -> 132725693 -> 964101198 -> 443981995 -> 261618089 -> 820436051 -> 425163964 -> 410064622 -> 53407379 -> 480010560 -> 162541025 -> 329724501 -> 535005054 -> 307299320 -> 428595286 -> 810771928 -> 957327573 -> 559553153 -> 275235743 -> 845234948 -> 442535461 -> 676426690 -> 118609373 -> 883957050 -> 211704335 -> 677008724 -> 57162126 -> 807077380 -> 633794161 -> 272723709 -> 158714000 -> 469616862 -> 590694338 -> 192502144 -> 509757554 -> 994353032 -> 498127101 -> 158592863 -> 633054223 -> 205364518 -> 363842260 -> 696099930 -> 445934274 -> 320435749 -> 778037280 -> 787189371 -> 519409731 -> 310302743 -> 613119959 -> 348450582 -> 879993243 -> 608464186 -> 169988159 -> 287708128 -> 45120198 -> 434008048 -> 847424796 -> 671479310 -> 695992787 -> 592161100 -> 814843966 -> 450794809 -> 696861614 -> 880073604 -> 11732774 -> 154241100 -> 422201961 -> 464272688 -> 33029030 -> 45707277 -> 171027388 -> 932319605 -> 648894443 -> 23092185 -> 177332857 -> 488853173 -> 858045307 -> 823415155 -> 901896241 -> 504185651 -> 478199051 -> 790874890 -> 28678602 -> 58374361 -> 606923426 -> 813095252 -> 542036061 -> 572070634 -> 727509339 -> 528193201 -> 253454723 -> 118670924 -> 412858824 -> 56791618 -> 542355312 -> 150393842 -> 688322971 -> 796163857 -> 350133800 -> 479423216 -> 897494675 -> 278558835 -> 365367241 -> 223471684 -> 733905467 -> 944820321 -> 931234412 -> 989525184 -> 596762237 -> 982714003 -> 731862414 -> 352176816 -> 242798242 -> 750538943 -> 15438181 -> 640680417 -> 633213222 -> 121346591 -> 909672007 -> 704424560 -> 980165295 -> 687514100 -> 430623970 -> 386681262 -> 822589614 -> 428614895 -> 297941300 -> 96157565 -> 292262313 -> 572997162 -> 315163828 -> 874318672 -> 185344824 -> 421910876 -> 394439735 -> 887869871 -> 103747918 -> 343033666 -> 491634967 -> 540300737 -> 969697654 -> 411435317 -> 911098180 -> 263536981 -> 699124803 -> 594599535 -> 246689136 -> 548174431 -> 133088750 -> 843486155 -> 366789082 -> 859946072 -> 716518518 -> 860144705 -> 431692872 -> 951051859 -> 190876129 -> 795888892 -> 112793875 -> 214436254 -> 680040096 -> 595951898 -> 104062737 -> 425981456 -> 114631423 -> 16871005 -> 407675165 -> 858414422 -> 945533914 -> 421599637 -> 81854721 -> 647578534 -> 719074229 -> 830966874 -> 738708522 -> 333246604 -> 8582817 -> 108238650 -> 284376987 -> 885360111 -> 803474734 -> 874192424 -> 100349133 -> 643341444 -> 834399507 -> 83859844 -> 37586852 -> 110305152 -> 595309015 -> 121386465 -> 88485511 -> 635569402 -> 525572392 -> 270883296 -> 491871713 -> 764820296 -> 352294555 -> 189337230 -> 18937376 -> 933117182 -> 549378101 -> 141885704 -> 714646 -> 244265938 -> 734898038 -> 556273294 -> 296811447 -> 933839281 -> 49308324 -> 219130921 -> 58901916 -> 8674342 -> 192227749 -> 944112675 -> 259395073 -> 683829639 -> 886962102 -> 490101253 -> 697025033 -> 663598267 -> 549576440 -> 748439168 -> 502149860 -> 364960913 -> 637098952 -> 361810777 -> 174860398 -> 974428862 -> 128636205 -> 842501617 -> 746706421 -> 842020977 -> 664884843 -> 740038768 -> 649423128 -> 699889301 -> 499107252 -> 243839394 -> 201458174 -> 669110526 -> 448568438 -> 555714848 -> 427804656 -> 806884471 -> 744260925 -> 600718522 -> 526304758 -> 122493791 -> 903891290 -> 905811707 -> 970704756 -> 227724054 -> 400792487 -> 380677543 -> 43022614 -> 229800249 -> 854999480 -> 84012614 -> 26417762 -> 596424485 -> 448956660 -> 242077623 -> 614544873 -> 109150310 -> 16175902 -> 312013080 -> 600028119 -> 39552771 -> 873995265 -> 598328671 -> 955623056 -> 679303591 -> 215478018 -> 69223249 -> 466949679 -> 137456068 -> 504385007 -> 572850165 -> 711287485 -> 609756722 -> 523973590 -> 827421622 -> 326380751 -> 992483209 -> 435184814 -> 566112325 -> 793517227 -> 848121252 -> 264428799 -> 90748231 -> 475706313 -> 95595999 -> 587419001 -> 692466081 -> 833361473 -> 783860582 -> 542020273 -> 630849793 -> 346457324 -> 822698826 -> 380604689 -> 747137209 -> 513538912 -> 865912551 -> 483392359 -> 36467690 -> 573242622 -> 496215961 -> 913932102 -> 426835924 -> 415401811 -> 177431031 -> 992615695 -> 587762758 -> 750866784 -> 527940009 -> 671109005 -> 703247208 -> 477142423 -> 487916988 -> 258661 -> 758678286 -> 610516103 -> 844903837 -> 596612460 -> 970351633 -> 527844249 -> 70206928 -> 121385504 -> 323668079 -> 319645327 -> 827294288 -> 587810555 -> 227845792 -> 75059836 -> 281811312 -> 622208361 -> 556503494 -> 538880006 -> 578920719 -> 422223761 -> 277115173 -> 901725649 -> 833885621 -> 781648507 -> 159480878 -> 186266690 -> 768697823 -> 898173843 -> 236373630 -> 725933407 -> 917796618 -> 991008270 -> 234814847 -> 431397053 -> 310047621 -> 669769766 -> 683002586 -> 109307051 -> 130897897 -> 934398982 -> 430766457 -> 51574638 -> 317287478 -> 986284511 -> 198805303 -> 88543910 -> 138738315 -> 798465816 -> 930200359 -> 43356879 -> 543739265 -> 731187362 -> 274816126 -> 747605219 -> 829326373 -> 438899742 -> 742215569 -> 675625958 -> 752007872 -> 823535577 -> 767373350 -> 561404369 -> 324878268 -> 541395351 -> 975281768 -> 568830196 -> 196763768 -> 456667935 -> 728420214 -> 234623003 -> 945228478 -> 482747172 -> 504125736 -> 953891277 -> 455994798 -> 918521783 -> 378255683 -> 953605853 -> 595329172 -> 800018748 -> 932669998 -> 647612366 -> 762384418 -> 880744069 -> 588779702 -> 693438429 -> 228231617 -> 384648773 -> 113946038 -> 218918137 -> 401769365 -> 507389128 -> 488854368 -> 348914335 -> 500150911 -> 160648231 -> 935685841 -> 866805149 -> 563913457 -> 243144792 -> 587796005 -> 336886526 -> 278489712
ans: 258661 -> 714646 -> 6878107 -> 7432520 -> 8582817 -> 8674342 -> 11249266 -> 11732774 -> 12078082 -> 12468469 -> 12849153 -> 12908870 -> 13501728 -> 14776161 -> 15438181 -> 16175902 -> 16871005 -> 18937376 -> 20274662 -> 20969942 -> 23092185 -> 26417762 -> 27465927 -> 28678602 -> 30426673 -> 32841755 -> 33029030 -> 34595256 -> 34981481 -> 35461147 -> 36467690 -> 37315974 -> 37586852 -> 39176849 -> 39552771 -> 40403676 -> 41279348 -> 42766699 -> 43022614 -> 43356879 -> 44100857 -> 45120198 -> 45286830 -> 45707277 -> 48615031 -> 49220227 -> 49308324 -> 51018068 -> 51574638 -> 53013780 -> 53407379 -> 56791618 -> 57162126 -> 58374361 -> 58901916 -> 59925586 -> 60245367 -> 61094497 -> 64204434 -> 66414667 -> 66726221 -> 69223249 -> 69485937 -> 70206928 -> 72438518 -> 75059836 -> 75062701 -> 78232236 -> 79353073 -> 80894932 -> 81032560 -> 81507263 -> 81854721 -> 83859844 -> 84012614 -> 84467496 -> 85476058 -> 85826654 -> 86391018 -> 87392483 -> 88485511 -> 88543910 -> 90748231 -> 91014217 -> 92887958 -> 93379264 -> 93579836 -> 93949270 -> 95506970 -> 95595999 -> 96157565 -> 96545247 -> 97988920 -> 98377374 -> 99215682 -> 100040059 -> 100349133 -> 102186175 -> 103747918 -> 104062737 -> 105133999 -> 105610781 -> 106162461 -> 107906972 -> 108238650 -> 109150310 -> 109307051 -> 109707870 -> 110305152 -> 110869269 -> 112793875 -> 113946038 -> 114315460 -> 114631423 -> 117353709 -> 117974496 -> 118022642 -> 118609373 -> 118670924 -> 120799148 -> 121346591 -> 121385504 -> 121386465 -> 121518680 -> 122493791 -> 127102507 -> 128636205 -> 129450753 -> 130025493 -> 130897897 -> 131101559 -> 132047797 -> 132725693 -> 133088750 -> 136028447 -> 137362283 -> 137456068 -> 138738315 -> 140243611 -> 141885704 -> 141902155 -> 145062585 -> 150175925 -> 150393842 -> 151054883 -> 151171878 -> 151397882 -> 153053704 -> 153168817 -> 153904795 -> 154005629 -> 154129701 -> 154241100 -> 155795309 -> 157881000 -> 158592863 -> 158714000 -> 159480878 -> 159573250 -> 160648231 -> 161631665 -> 162541025 -> 166025106 -> 169988159 -> 170908374 -> 171027388 -> 171357635 -> 171529860 -> 172264252 -> 173231570 -> 174362463 -> 174860398 -> 175336069 -> 176038961 -> 176604733 -> 177130003 -> 177332857 -> 177431031 -> 178669148 -> 179256976 -> 179710618 -> 183614144 -> 185344824 -> 185492101 -> 185967556 -> 186266690 -> 186543090 -> 188375445 -> 189337230 -> 189449044 -> 190876129 -> 192227749 -> 192502144 -> 196763768 -> 198805303 -> 199382856 -> 201458174 -> 205364518 -> 207136768 -> 207267983 -> 209281464 -> 211704335 -> 212140121 -> 212366523 -> 212880636 -> 214436254 -> 214586540 -> 215478018 -> 216846076 -> 218918137 -> 219130921 -> 220264929 -> 222029151 -> 223471684 -> 223483997 -> 227724054 -> 227845792 -> 228231617 -> 228350511 -> 229800249 -> 230712557 -> 234233130 -> 234623003 -> 234814847 -> 236373630 -> 237785432 -> 241021429 -> 241758896 -> 242077623 -> 242715952 -> 242798242 -> 243144792 -> 243839394 -> 244265938 -> 244528756 -> 244966826 -> 246689136 -> 249869080 -> 249954981 -> 250124682 -> 250879840 -> 251097756 -> 252644406 -> 253156171 -> 253454723 -> 254766569 -> 254816064 -> 255099119 -> 259395073 -> 261618089 -> 262329523 -> 262421166 -> 263536981 -> 264035051 -> 264428799 -> 264630949 -> 266526744 -> 267333682 -> 269356071 -> 270883296 -> 272723709 -> 274816126 -> 275235743 -> 277115173 -> 278489712 -> 278558835 -> 280943506 -> 281811312 -> 284025072 -> 284376987 -> 287070362 -> 287708128 -> 288173485 -> 292253726 -> 292262313 -> 292326585 -> 292450276 -> 293449535 -> 294876238 -> 295781627 -> 296302132 -> 296811447 -> 297941300 -> 299348392 -> 302937777 -> 303127788 -> 303578335 -> 305773793 -> 306162641 -> 307299320 -> 310047621 -> 310302743 -> 310650265 -> 312013080 -> 312258045 -> 312862398 -> 313240595 -> 313477762 -> 315163828 -> 316576554 -> 317287478 -> 319645327 -> 320435749 -> 323668079 -> 323750188 -> 324878268 -> 325924423 -> 326250612 -> 326380751 -> 327373403 -> 329724501 -> 329980353 -> 332947055 -> 333246604 -> 333408239 -> 333565831 -> 335793380 -> 336886526 -> 339872483 -> 339900421 -> 343033666 -> 345855696 -> 346457324 -> 346762981 -> 346819941 -> 348179746 -> 348450582 -> 348914335 -> 350133800 -> 352176816 -> 352294555 -> 353913763 -> 355258937 -> 356953112 -> 357248678 -> 358440612 -> 360124248 -> 360795265 -> 361810777 -> 363125267 -> 363197205 -> 363835515 -> 363842260 -> 364753782 -> 364960913 -> 365367241 -> 366789082 -> 367620174 -> 368956904 -> 370078340 -> 370131741 -> 370613729 -> 372285310 -> 374141855 -> 374434767 -> 377684165 -> 378028260 -> 378255683 -> 379216509 -> 380604689 -> 380677543 -> 381491402 -> 382230543 -> 383522324 -> 384464830 -> 384648773 -> 386681262 -> 388433211 -> 391318050 -> 392450345 -> 393865768 -> 394284153 -> 394439735 -> 396469344 -> 396511063 -> 398082323 -> 398174104 -> 398663993 -> 399199566 -> 400792487 -> 401769365 -> 407675165 -> 409586091 -> 410064622 -> 411367869 -> 411435317 -> 412858824 -> 413581628 -> 415054960 -> 415401811 -> 415824560 -> 416567959 -> 417242214 -> 419643723 -> 419913548 -> 421495721 -> 421599637 -> 421910876 -> 422201961 -> 422223761 -> 424214868 -> 424708075 -> 425088008 -> 425163964 -> 425981456 -> 426835924 -> 427285203 -> 427804656 -> 428595286 -> 428614895 -> 428690650 -> 428852399 -> 430623970 -> 430766457 -> 431397053 -> 431692872 -> 432380904 -> 432874240 -> 434008048 -> 434546921 -> 435184814 -> 438899742 -> 442535461 -> 442770171 -> 443981995 -> 445934274 -> 448568438 -> 448956660 -> 449309303 -> 450692100 -> 450794809 -> 454570515 -> 454574255 -> 455994798 -> 456133774 -> 456454134 -> 456667935 -> 458067239 -> 462591872 -> 462845943 -> 463538687 -> 463594903 -> 464272688 -> 464446872 -> 464989102 -> 465702978 -> 466949679 -> 467381744 -> 469616862 -> 469770291 -> 469795166 -> 469843935 -> 471213704 -> 471990487 -> 475706313 -> 475988254 -> 477142423 -> 477946349 -> 478199051 -> 479423216 -> 480010560 -> 480566607 -> 480732453 -> 480746988 -> 481403051 -> 482747172 -> 483392359 -> 484146784 -> 484646849 -> 485214052 -> 487916988 -> 488853173 -> 488854368 -> 489458313 -> 490101253 -> 490257219 -> 491595685 -> 491634967 -> 491871713 -> 492070006 -> 493758270 -> 496215961 -> 496988249 -> 497342209 -> 497606470 -> 498127101 -> 499107252 -> 499222554 -> 499619803 -> 500150911 -> 502149860 -> 502635800 -> 504125736 -> 504185651 -> 504385007 -> 506533113 -> 507389128 -> 509621309 -> 509757554 -> 512648990 -> 513517456 -> 513538912 -> 514152731 -> 516044364 -> 516707735 -> 518498902 -> 518866115 -> 519409731 -> 519918322 -> 520072891 -> 520365646 -> 521201797 -> 523973590 -> 525572392 -> 526304758 -> 527844249 -> 527940009 -> 528027951 -> 528032091 -> 528193201 -> 528276358 -> 528355130 -> 530968759 -> 532577411 -> 533308258 -> 533346274 -> 533747880 -> 535005054 -> 537997586 -> 538713282 -> 538880006 -> 539166285 -> 539714928 -> 540300737 -> 541395351 -> 541459528 -> 541866471 -> 542020273 -> 542036061 -> 542355312 -> 543739265 -> 544017212 -> 545972852 -> 546366954 -> 546831196 -> 548174431 -> 548409253 -> 549378101 -> 549576440 -> 549837139 -> 553109864 -> 553794532 -> 554102886 -> 555714848 -> 556273294 -> 556503494 -> 558821715 -> 559553153 -> 561404369 -> 562831720 -> 563112468 -> 563913457 -> 566001279 -> 566112325 -> 567725883 -> 568830196 -> 569421184 -> 571190738 -> 572070634 -> 572571817 -> 572850165 -> 572959294 -> 572997162 -> 573242622 -> 574279054 -> 574575074 -> 575345385 -> 576653137 -> 578920719 -> 583537140 -> 585921487 -> 585957601 -> 586351356 -> 587011240 -> 587419001 -> 587762758 -> 587796005 -> 587810555 -> 588779702 -> 590694338 -> 591125951 -> 592071886 -> 592161100 -> 593304802 -> 594599535 -> 595309015 -> 595329172 -> 595951898 -> 596046013 -> 596424485 -> 596612460 -> 596711642 -> 596762237 -> 598328671 -> 598841249 -> 599037845 -> 599834436 -> 600028119 -> 600321283 -> 600633298 -> 600718522 -> 602312716 -> 602675624 -> 605466253 -> 606923426 -> 607192722 -> 607588192 -> 608464186 -> 608870188 -> 609641668 -> 609756722 -> 610516103 -> 610525190 -> 610599487 -> 612541717 -> 613011407 -> 613119959 -> 613353427 -> 614544873 -> 614792379 -> 617331156 -> 620619609 -> 622208361 -> 626017078 -> 627219981 -> 628904363 -> 630849793 -> 631127776 -> 632873582 -> 633054223 -> 633213222 -> 633794161 -> 634136397 -> 634888975 -> 635184870 -> 635498221 -> 635569402 -> 635660749 -> 635753550 -> 635847587 -> 636209350 -> 637098952 -> 639905006 -> 640680417 -> 643169450 -> 643341444 -> 647578534 -> 647612366 -> 648894443 -> 649423128 -> 650259795 -> 651871391 -> 658271868 -> 660349457 -> 661885861 -> 662164082 -> 662702288 -> 663598267 -> 664884843 -> 667413506 -> 667461795 -> 667699901 -> 668066206 -> 669110526 -> 669769766 -> 670700430 -> 670790535 -> 671109005 -> 671479310 -> 672367117 -> 674876017 -> 675625958 -> 676426690 -> 677008724 -> 678261128 -> 678511562 -> 678623685 -> 679303591 -> 680040096 -> 681202907 -> 683002586 -> 683829639 -> 683993508 -> 685075985 -> 686159268 -> 687000432 -> 687514100 -> 688275311 -> 688322971 -> 688966589 -> 691908982 -> 692466081 -> 692759089 -> 692859933 -> 693438429 -> 695992787 -> 696099930 -> 696861614 -> 697025033 -> 697623482 -> 698090931 -> 699124803 -> 699187548 -> 699889301 -> 701147134 -> 702219720 -> 703247208 -> 704424560 -> 707969185 -> 708380456 -> 711287485 -> 713063230 -> 716518518 -> 718480726 -> 718591717 -> 718837098 -> 719074229 -> 721339682 -> 721444487 -> 723810924 -> 724214160 -> 725933407 -> 726878008 -> 727509339 -> 727553456 -> 728166002 -> 728420214 -> 728587994 -> 731097730 -> 731187362 -> 731862414 -> 732710968 -> 733905467 -> 734280830 -> 734851239 -> 734898038 -> 735148866 -> 738610805 -> 738708522 -> 740038768 -> 740304539 -> 740431605 -> 740467737 -> 741474724 -> 742215569 -> 743186043 -> 744260925 -> 744684815 -> 745532561 -> 746305756 -> 746706421 -> 746709511 -> 747137209 -> 747605219 -> 747767663 -> 748439168 -> 749375850 -> 750538943 -> 750866784 -> 752007872 -> 753380600 -> 754829986 -> 755799041 -> 755974684 -> 756491346 -> 758451405 -> 758678286 -> 759955396 -> 760055890 -> 760551415 -> 761038828 -> 761764681 -> 762147231 -> 762262616 -> 762384418 -> 764820296 -> 765412620 -> 766749513 -> 767373350 -> 768697823 -> 769523200 -> 769530916 -> 778037280 -> 778816175 -> 781396134 -> 781438321 -> 781648507 -> 781999599 -> 783179047 -> 783860582 -> 787189371 -> 787413729 -> 788331505 -> 790100856 -> 790874890 -> 793517227 -> 794322820 -> 795888892 -> 796163857 -> 796244329 -> 797310166 -> 797941018 -> 798465816 -> 798939710 -> 800018748 -> 800558217 -> 803474734 -> 806884471 -> 807077380 -> 809710936 -> 810771928 -> 812328185 -> 813095252 -> 814843966 -> 816142736 -> 820436051 -> 822589614 -> 822698826 -> 823415155 -> 823535577 -> 823768273 -> 825995684 -> 827024650 -> 827294288 -> 827421622 -> 829326373 -> 829775745 -> 830062920 -> 830566383 -> 830966874 -> 833361473 -> 833885621 -> 834399507 -> 839006667 -> 840216498 -> 841070314 -> 842020977 -> 842501617 -> 843486155 -> 844903837 -> 845234948 -> 847424796 -> 847792560 -> 848121252 -> 853424907 -> 854999480 -> 858045307 -> 858284209 -> 858414422 -> 859702841 -> 859946072 -> 860144705 -> 864985168 -> 865912551 -> 866620313 -> 866805149 -> 868508959 -> 871785024 -> 873459110 -> 873995265 -> 874192424 -> 874318672 -> 874861569 -> 875232083 -> 875622739 -> 875669454 -> 876203998 -> 876704115 -> 877987519 -> 878117623 -> 878421819 -> 879221226 -> 879993243 -> 880073604 -> 880744069 -> 882351336 -> 882444553 -> 883957050 -> 885360111 -> 886923192 -> 886962102 -> 887869871 -> 891704464 -> 891873257 -> 891988748 -> 892496028 -> 894620325 -> 895880742 -> 897494675 -> 898173843 -> 898275732 -> 901725649 -> 901896241 -> 903891290 -> 905811707 -> 907062447 -> 909672007 -> 910622565 -> 911098180 -> 913455251 -> 913932102 -> 917140768 -> 917796618 -> 918521783 -> 919146309 -> 920354693 -> 922030187 -> 922793086 -> 923238017 -> 923285780 -> 923598961 -> 924561327 -> 925843329 -> 927755982 -> 928361751 -> 928904382 -> 930200359 -> 930616017 -> 931234412 -> 931241540 -> 932319605 -> 932669998 -> 933117182 -> 933132368 -> 933839281 -> 934398982 -> 935685841 -> 937099556 -> 937317308 -> 938263767 -> 939052124 -> 939057374 -> 939271406 -> 940680352 -> 940863379 -> 944112675 -> 944820321 -> 945228478 -> 945533914 -> 945961361 -> 950224597 -> 950576426 -> 950627844 -> 951051859 -> 953545820 -> 953605853 -> 953891277 -> 955388119 -> 955623056 -> 957327573 -> 958027930 -> 962489952 -> 964101198 -> 964196532 -> 964336081 -> 964691289 -> 965752893 -> 966464524 -> 968121021 -> 969465932 -> 969697654 -> 970351633 -> 970704756 -> 973237431 -> 973451428 -> 974428862 -> 974988807 -> 975281768 -> 975617245 -> 977994151 -> 979996269 -> 980165295 -> 982714003 -> 983490312 -> 985362870 -> 986276328 -> 986284511 -> 989525184 -> 989626450 -> 990785192 -> 991008270 -> 992172469 -> 992300401 -> 992449061 -> 992483209 -> 992615695 -> 992658514 -> 993083195 -> 994353032 -> 997081869
Quick sort elapsed time (s): 5.82125E-4
Insertion sort elapsed time (s): 0.002824605
a = 10000
Quick sort elapsed time (s): 0.0013300940000000002
Insertion sort elapsed time (s): 0.09151909
a = 100000
Quick sort elapsed time (s): 0.010357571999999999
Insertion sort elapsed time (s): 8.667724339000001
a = 1000000
Quick sort elapsed time (s): 0.10041739100000001
a = 10000000
Quick sort elapsed time (s): 1.185548107
a = 100000000
Quick sort elapsed time (s): 14.236274503
a = 1000000000
Quick sort elapsed time (s): 319.13132124699996

Process finished with exit code 0
 */
